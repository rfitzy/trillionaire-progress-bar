{"version":3,"sources":["iterable/orderby.ts"],"names":[],"mappings":"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","file":"orderby.js","sourcesContent":["import { IterableX } from './iterablex';\nimport { sorter as defaultSorter } from '../internal/sorter';\n\nexport abstract class OrderedIterableBaseX<TSource> extends IterableX<TSource> {\n  _source: Iterable<TSource>;\n\n  constructor(source: Iterable<TSource>) {\n    super();\n    this._source = source;\n  }\n\n  *[Symbol.iterator]() {\n    const array = Array.from<TSource>(this._source);\n    const len = array.length;\n    const indices = new Array<number>(len);\n    for (let i = 0, len = array.length; i < len; i++) {\n      indices[i] = i;\n    }\n\n    indices.sort(this._getSorter(array));\n    for (const index of indices) {\n      yield array[index];\n    }\n  }\n\n  thenBy<TKey>(\n    keySelector: (item: TSource) => TKey,\n    comparer: (fst: TKey, snd: TKey) => number = defaultSorter\n  ): OrderedIterableBaseX<TSource> {\n    /* tslint:disable-next-line: no-use-before-declare */\n    return new OrderedIterableX<TKey, TSource>(this._source, keySelector, comparer, false, this);\n  }\n\n  thenByDescending<TKey>(\n    keySelector: (item: TSource) => TKey,\n    comparer: (fst: TKey, snd: TKey) => number = defaultSorter\n  ): OrderedIterableBaseX<TSource> {\n    /* tslint:disable-next-line: no-use-before-declare */\n    return new OrderedIterableX<TKey, TSource>(this._source, keySelector, comparer, true, this);\n  }\n\n  abstract _getSorter(\n    elements: TSource[],\n    next?: (x: number, y: number) => number\n  ): (x: number, y: number) => number;\n}\n\nexport class OrderedIterableX<TKey, TSource> extends OrderedIterableBaseX<TSource> {\n  private _keySelector: (item: TSource) => TKey;\n  private _comparer: (fst: TKey, snd: TKey) => number;\n  private _descending: boolean;\n  private _parent?: OrderedIterableBaseX<TSource>;\n\n  constructor(\n    source: Iterable<TSource>,\n    keySelector: (item: TSource) => TKey,\n    comparer: (fst: TKey, snd: TKey) => number,\n    descending: boolean,\n    parent?: OrderedIterableBaseX<TSource>\n  ) {\n    super(source);\n    this._keySelector = keySelector;\n    this._comparer = comparer;\n    this._descending = descending;\n    this._parent = parent;\n  }\n\n  _getSorter(\n    elements: TSource[],\n    next?: (x: number, y: number) => number\n  ): (x: number, y: number) => number {\n    const keys = elements.map(this._keySelector);\n    const comparer = this._comparer;\n    const parent = this._parent;\n    const descending = this._descending;\n    const sorter = (x: number, y: number): number => {\n      const result = comparer(keys[x], keys[y]);\n      if (result === 0) {\n        return next ? next(x, y) : x - y;\n      }\n\n      return descending ? -result : result;\n    };\n\n    return parent ? parent._getSorter(elements, sorter) : sorter;\n  }\n}\n\nexport function orderBy<TKey, TSource>(\n  source: Iterable<TSource>,\n  keySelector: (item: TSource) => TKey,\n  comparer: (fst: TKey, snd: TKey) => number = defaultSorter\n): OrderedIterableX<TKey, TSource> {\n  return new OrderedIterableX<TKey, TSource>(source, keySelector, comparer, false);\n}\n\nexport function orderByDescending<TKey, TSource>(\n  source: Iterable<TSource>,\n  keySelector: (item: TSource) => TKey,\n  comparer: (fst: TKey, snd: TKey) => number = defaultSorter\n): OrderedIterableX<TKey, TSource> {\n  return new OrderedIterableX<TKey, TSource>(source, keySelector, comparer, true);\n}\n\nexport function thenBy<TKey, TSource>(\n  source: OrderedIterableBaseX<TSource>,\n  keySelector: (item: TSource) => TKey,\n  comparer: (fst: TKey, snd: TKey) => number = defaultSorter\n): OrderedIterableX<TKey, TSource> {\n  return new OrderedIterableX<TKey, TSource>(source._source, keySelector, comparer, false, source);\n}\n\nexport function thenByDescending<TKey, TSource>(\n  source: OrderedIterableBaseX<TSource>,\n  keySelector: (item: TSource) => TKey,\n  comparer: (fst: TKey, snd: TKey) => number = defaultSorter\n): OrderedIterableX<TKey, TSource> {\n  return new OrderedIterableX<TKey, TSource>(source._source, keySelector, comparer, true, source);\n}\n"]}